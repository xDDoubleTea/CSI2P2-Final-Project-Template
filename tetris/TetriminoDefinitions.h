#ifndef TETRIMINO_DEFINITIONS_H
#define TETRIMINO_DEFINITIONS_H

#include <allegro5/allegro_color.h>
#include <array>
#include <sys/types.h>

namespace Tetris {

struct Point {
    int x;
    int y;
};

struct ColorRGB {
    u_int8_t r, g, b;
};

enum class TetriminoType {
    O = 0,
    S,
    Z,
    T,
    I,
    J,
    L,
};

constexpr size_t NUM_TYPES = 8;
constexpr size_t ROTATION_STATES = 4;
constexpr size_t BLOCKS_PER_TETRIMINO = 4;
constexpr size_t KICK_TESTS = 5;

constexpr std::array<ColorRGB, NUM_TYPES> tetrimino_colors = {
    {
        { 255, 255, 0 },
        { 187, 235, 102 },
        { 194, 62, 71 },
        { 177, 77, 166 },
        { 78, 207, 158 },
        { 96, 78, 181 },
        { 199, 177, 67 },
        { 100, 100, 100 },
    },
};
constexpr std::array<ColorRGB, NUM_TYPES> tetrimino_ghost_block_colors = {
    {
        { 205, 205, 0 },
        { 137, 185, 52 },
        { 144, 12, 21 },
        { 127, 27, 116 },
        { 28, 157, 108 },
        { 46, 28, 131 },
        { 149, 127, 17 },
    },
};

constexpr std::array<std::array<std::array<Point, BLOCKS_PER_TETRIMINO>, ROTATION_STATES>, NUM_TYPES> tetrimino_shapes = {
    {
        // O
        {
            {
                { { { 0, 0 }, { 0, 1 }, { 1, 0 }, { 1, 1 } } },
                { { { 0, 0 }, { 0, 1 }, { 1, 0 }, { 1, 1 } } },
                { { { 0, 0 }, { 0, 1 }, { 1, 0 }, { 1, 1 } } },
                { { { 0, 0 }, { 0, 1 }, { 1, 0 }, { 1, 1 } } },
            },
        },
        // S
        {
            {
                { { { 0, 0 }, { -1, 0 }, { 0, -1 }, { 1, -1 } } },
                { { { 0, 0 }, { 1, 0 }, { 0, -1 }, { 1, 1 } } },
                { { { 0, 0 }, { 0, 1 }, { -1, 1 }, { 1, 0 } } },
                { { { 0, 0 }, { 0, 1 }, { -1, 0 }, { -1, -1 } } },
            },
        },
        // Z
        {
            {
                { { { 0, 0 }, { 0, -1 }, { -1, -1 }, { 1, 0 } } },
                { { { 0, 0 }, { 1, 0 }, { 1, -1 }, { 0, 1 } } },
                { { { 0, 0 }, { -1, 0 }, { 0, 1 }, { 1, 1 } } },
                { { { 0, 0 }, { -1, 0 }, { -1, 1 }, { 0, -1 } } },
            },
        },
        // T
        {
            {
                { { { 0, 0 }, { 0, -1 }, { -1, 0 }, { 1, 0 } } },
                { { { 0, 0 }, { 0, -1 }, { 1, 0 }, { 0, 1 } } },
                { { { 0, 0 }, { -1, 0 }, { 0, 1 }, { 1, 0 } } },
                { { { 0, 0 }, { 0, -1 }, { 0, 1 }, { -1, 0 } } },
            },
        },
        // I
        {
            {
                { { { 0, 0 }, { 1, 0 }, { -1, 0 }, { 2, 0 } } },
                { { { 0, 0 }, { 0, 1 }, { 0, -1 }, { 0, -2 } } },
                { { { 0, 0 }, { 1, 0 }, { -1, 0 }, { 2, 0 } } },
                { { { 0, 0 }, { 0, 1 }, { 0, -1 }, { 0, -2 } } },
            },
        },
        // J
        {
            {
                { { { 0, 0 }, { -1, 0 }, { -1, -1 }, { 1, 0 } } },
                { { { 0, 0 }, { 0, 1 }, { 0, -1 }, { 1, -1 } } },
                { { { 0, 0 }, { -1, 0 }, { 1, 1 }, { 1, 0 } } },
                { { { 0, 0 }, { 0, 1 }, { 0, -1 }, { -1, 1 } } },
            },
        },
        // L
        {
            {
                { { { 0, 0 }, { -1, 0 }, { 1, 0 }, { 1, -1 } } },
                { { { 0, 0 }, { 0, 1 }, { 0, -1 }, { 1, 1 } } },
                { { { 0, 0 }, { -1, 0 }, { 1, 0 }, { -1, 1 } } },
                { { { 0, 0 }, { 0, 1 }, { 0, -1 }, { -1, -1 } } },
            },
        },
    },
};
constexpr std::array<std::array<std::array<Point, KICK_TESTS>, ROTATION_STATES>, 2> srs_offsets = { { // Table 0 (Standard)
    { {
        { { { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 } } }, // 0 (North)
        { { { 0, 0 }, { 1, 0 }, { 1, -1 }, { 0, 2 }, { 1, 2 } } }, // 1 (East)
        { { { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 } } }, // 2 (South)
        { { { 0, 0 }, { -1, 0 }, { -1, -1 }, { 0, 2 }, { -1, 2 } } } // 3 (West)
    } },
    // Table 1 (I Piece)
    { {
        { { { 0, 0 }, { -1, 0 }, { 2, 0 }, { -1, 0 }, { 2, 0 } } }, // 0
        { { { -1, 0 }, { 0, 0 }, { 0, 0 }, { 0, 1 }, { 0, -2 } } }, // 1
        { { { -1, 1 }, { 1, 1 }, { -2, 1 }, { 1, 0 }, { -2, 0 } } }, // 2
        { { { 0, 1 }, { 0, 1 }, { 0, 1 }, { 0, -1 }, { 0, 2 } } } // 3
    } } } };
}

#endif
